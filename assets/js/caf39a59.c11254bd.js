"use strict";(self.webpackChunkjellyfish_docs=self.webpackChunkjellyfish_docs||[]).push([[6982],{3905:(t,e,n)=>{n.d(e,{Zo:()=>u,kt:()=>k});var a=n(7294);function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){if(null==t)return{};var n,a,l=function(t,e){if(null==t)return{};var n,a,l={},r=Object.keys(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||(l[n]=t[n]);return l}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(l[n]=t[n])}return l}var p=a.createContext({}),m=function(t){var e=a.useContext(p),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},u=function(t){var e=m(t.components);return a.createElement(p.Provider,{value:e},t.children)},o="mdxType",d={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},c=a.forwardRef((function(t,e){var n=t.components,l=t.mdxType,r=t.originalType,p=t.parentName,u=s(t,["components","mdxType","originalType","parentName"]),o=m(n),c=l,k=o["".concat(p,".").concat(c)]||o[c]||d[c]||r;return n?a.createElement(k,i(i({ref:e},u),{},{components:n})):a.createElement(k,i({ref:e},u))}));function k(t,e){var n=arguments,l=e&&e.mdxType;if("string"==typeof t||l){var r=n.length,i=new Array(r);i[0]=c;var s={};for(var p in e)hasOwnProperty.call(e,p)&&(s[p]=e[p]);s.originalType=t,s[o]="string"==typeof t?t:l,i[1]=s;for(var m=2;m<r;m++)i[m]=n[m];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},8035:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>p,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>m});var a=n(7462),l=(n(7294),n(3905));const r={},i="Benchmarks",s={unversionedId:"benchmarks",id:"benchmarks",title:"Benchmarks",description:"Performance tests for our Jellyfish media server were carried out with particular emphasis",source:"@site/docs/benchmarks.md",sourceDirName:".",slug:"/benchmarks",permalink:"/jellyfish-docs/next/benchmarks",draft:!1,editUrl:"https://github.com/jellyfish-dev/jellyfish-docs/docs/benchmarks.md",tags:[],version:"current",frontMatter:{},sidebar:"mainSidebar",previous:{title:"Fly.io (experimental)",permalink:"/jellyfish-docs/next/deploying/fly_io"},next:{title:"Design Docs",permalink:"/jellyfish-docs/next/for_developers/design_docs"}},p={},m=[{value:"HLS",id:"hls",level:2},{value:"Setup",id:"setup",level:3},{value:"Machine specs",id:"machine-specs",level:4},{value:"Test results",id:"test-results",level:3},{value:"Regular HLS",id:"regular-hls",level:4},{value:"Low-Latency HLS",id:"low-latency-hls",level:4}],u={toc:m},o="wrapper";function d(t){let{components:e,...n}=t;return(0,l.kt)(o,(0,a.Z)({},u,n,{components:e,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"benchmarks"},"Benchmarks"),(0,l.kt)("p",null,"Performance tests for our Jellyfish media server were carried out with particular emphasis\non quantifying its real-world capabilities, even under intense workloads."),(0,l.kt)("h2",{id:"hls"},"HLS"),(0,l.kt)("p",null,"The conducted stress tests were geared towards assessing performance of both regular HLS\nand Low-Latency HLS under substantial load."),(0,l.kt)("p",null,"We assumed a livestream scenario, where all of the clients demanded the most recent segments or partial segments\nas they were produced. This model closely simulates real-time broadcasting situations where all participants\nare consuming the same (latest) content concurrently. It could be contrasted e.g. with a video-on-demand (VOD)\nscenario, where any client can request any segment at any given time."),(0,l.kt)("h3",{id:"setup"},"Setup"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Machine ",(0,l.kt)("inlineCode",{parentName:"p"},"A"),", running Jellyfish with one room"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"One WebRTC peer in the room (WebRTC video stream with ",(0,l.kt)("strong",{parentName:"li"},"constant bitrate of 1.8 Mbps"),")"),(0,l.kt)("li",{parentName:"ul"},"One HLS component in the room (segment length: 6 s, partial segment length: 1 s)"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Machine ",(0,l.kt)("inlineCode",{parentName:"p"},"B"),", running a stress test utility"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"The utility steadily increases the number of simulated clients over the course of the test, up to a given amount"),(0,l.kt)("li",{parentName:"ul"},"Clients simulate an HLS player continuously requesting the most recent segments/partials\n(as if watching a livestream)"),(0,l.kt)("li",{parentName:"ul"},"Each client opens a separate connection to Jellyfish on machine ",(0,l.kt)("inlineCode",{parentName:"li"},"A")," (no connection pooling)")))),(0,l.kt)("h4",{id:"machine-specs"},"Machine specs"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"CPU: AMD EPYC 7502P (32 cores, 64 threads at 2.5 GHz)"),(0,l.kt)("li",{parentName:"ul"},"Memory: 128 GB"),(0,l.kt)("li",{parentName:"ul"},"Network bandwidth (",(0,l.kt)("inlineCode",{parentName:"li"},"A <---\x3e B"),"): 10 Gbps")),(0,l.kt)("h3",{id:"test-results"},"Test results"),(0,l.kt)("p",null,"We varied the number of client connections and recorded server metrics at each level\nto determine how it would perform under increasing load. Values for mean incoming throughput,\nmean and peak outgoing throughput, peak memory used, peak CPU utilisation and mean request latency\n(grouped by request type) were all recorded."),(0,l.kt)("p",null,"Before any clients were connected to the server, the memory usage stood at 130 MB\nand CPU utilisation was noted at 11%. These values serve as the base or idle state of the server\nfor comparison against the usage under stress testing."),(0,l.kt)("admonition",{type:"info"},(0,l.kt)("p",{parentName:"admonition"},"It's important to remember that, in the context of HLS, the outgoing throughput is greatly influenced by the bitrate\nof the generated segments, which is directly connected to the bitrate of the streams used for segment generation.\nSpecifically, for video streams featuring high and fluctuating bitrates (such as sports events and video game\nlive streams) you may typically observe amplified mean and peak outgoing throughputs.")),(0,l.kt)("admonition",{title:"Caveat",type:"caution"},(0,l.kt)("p",{parentName:"admonition"},"Values ",(0,l.kt)("em",{parentName:"p"},"italicised")," in the Latency columns indicate instances where network bandwidth limits were reached,\nresulting in throttling; in such cases, the observed latency ",(0,l.kt)("strong",{parentName:"p"},"does not")," reflect the server's\ninnate processing capabilities.")),(0,l.kt)("h4",{id:"regular-hls"},"Regular HLS"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Client connections"),(0,l.kt)("th",{parentName:"tr",align:null},"Incoming throughput (mean)"),(0,l.kt)("th",{parentName:"tr",align:null},"Outgoing throughput (mean)"),(0,l.kt)("th",{parentName:"tr",align:null},"Outgoing throughput (peak)"),(0,l.kt)("th",{parentName:"tr",align:null},"Memory used (peak)"),(0,l.kt)("th",{parentName:"tr",align:null},"CPU utilisation (peak)"),(0,l.kt)("th",{parentName:"tr",align:null},"Playlist request latency (mean)"),(0,l.kt)("th",{parentName:"tr",align:null},"Segment request latency (mean)"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"500"),(0,l.kt)("td",{parentName:"tr",align:null},"6 Mbps"),(0,l.kt)("td",{parentName:"tr",align:null},"0.9 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"1.3 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"0.9 GB"),(0,l.kt)("td",{parentName:"tr",align:null},"18%"),(0,l.kt)("td",{parentName:"tr",align:null},"4 ms"),(0,l.kt)("td",{parentName:"tr",align:null},"66 ms")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"1000"),(0,l.kt)("td",{parentName:"tr",align:null},"12 Mbps"),(0,l.kt)("td",{parentName:"tr",align:null},"1.9 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"2.6 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"1.9 GB"),(0,l.kt)("td",{parentName:"tr",align:null},"19%"),(0,l.kt)("td",{parentName:"tr",align:null},"3 ms"),(0,l.kt)("td",{parentName:"tr",align:null},"65 ms")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"2000"),(0,l.kt)("td",{parentName:"tr",align:null},"24 Mbps"),(0,l.kt)("td",{parentName:"tr",align:null},"3.6 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"5.2 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"2.8 GB"),(0,l.kt)("td",{parentName:"tr",align:null},"23%"),(0,l.kt)("td",{parentName:"tr",align:null},"3 ms"),(0,l.kt)("td",{parentName:"tr",align:null},"66 ms")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"3000"),(0,l.kt)("td",{parentName:"tr",align:null},"36 Mbps"),(0,l.kt)("td",{parentName:"tr",align:null},"5.1 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"6.5 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"4.5 GB"),(0,l.kt)("td",{parentName:"tr",align:null},"30%"),(0,l.kt)("td",{parentName:"tr",align:null},"4 ms"),(0,l.kt)("td",{parentName:"tr",align:null},"67 ms")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"4000"),(0,l.kt)("td",{parentName:"tr",align:null},"48 Mbps"),(0,l.kt)("td",{parentName:"tr",align:null},"7.0 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"9.2 Gbps ",(0,l.kt)("em",{parentName:"td"},"(limit)")),(0,l.kt)("td",{parentName:"tr",align:null},"9.2 GB"),(0,l.kt)("td",{parentName:"tr",align:null},"34%"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("i",null,"17 ms*")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("i",null,"243 ms*"))))),(0,l.kt)("h4",{id:"low-latency-hls"},"Low-Latency HLS"),(0,l.kt)("p",null,'In Low-Latency HLS, the server intentionally delays the response to playlist requests\nuntil the specifically requested partial segment becomes available.\nThis makes the "Playlist request latency (mean)" metric meaningless, and it is thus omitted from the following table.'),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Client connections"),(0,l.kt)("th",{parentName:"tr",align:null},"Incoming throughput (mean)"),(0,l.kt)("th",{parentName:"tr",align:null},"Outgoing throughput (mean)"),(0,l.kt)("th",{parentName:"tr",align:null},"Outgoing throughput (peak)"),(0,l.kt)("th",{parentName:"tr",align:null},"Memory used (peak)"),(0,l.kt)("th",{parentName:"tr",align:null},"CPU utilisation (peak)"),(0,l.kt)("th",{parentName:"tr",align:null},"Partial segment request latency (mean)"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"500"),(0,l.kt)("td",{parentName:"tr",align:null},"25 Mbps"),(0,l.kt)("td",{parentName:"tr",align:null},"1.1 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"4.7 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"210 MB"),(0,l.kt)("td",{parentName:"tr",align:null},"25%"),(0,l.kt)("td",{parentName:"tr",align:null},"98 ms")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"1000"),(0,l.kt)("td",{parentName:"tr",align:null},"50 Mbps"),(0,l.kt)("td",{parentName:"tr",align:null},"2.3 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"9.0 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"290 MB"),(0,l.kt)("td",{parentName:"tr",align:null},"34%"),(0,l.kt)("td",{parentName:"tr",align:null},"138 ms")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"1500"),(0,l.kt)("td",{parentName:"tr",align:null},"75 Mbps"),(0,l.kt)("td",{parentName:"tr",align:null},"3.3 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"9.2 Gbps ",(0,l.kt)("em",{parentName:"td"},"(limit)")),(0,l.kt)("td",{parentName:"tr",align:null},"340 MB"),(0,l.kt)("td",{parentName:"tr",align:null},"43%"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("i",null,"244 ms*"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"2000"),(0,l.kt)("td",{parentName:"tr",align:null},"100 Mbps"),(0,l.kt)("td",{parentName:"tr",align:null},"4.5 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"9.2 Gbps ",(0,l.kt)("em",{parentName:"td"},"(limit)")),(0,l.kt)("td",{parentName:"tr",align:null},"410 MB"),(0,l.kt)("td",{parentName:"tr",align:null},"47%"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("i",null,"341 ms*"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"2500"),(0,l.kt)("td",{parentName:"tr",align:null},"125 Mbps"),(0,l.kt)("td",{parentName:"tr",align:null},"5.7 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"9.2 Gbps ",(0,l.kt)("em",{parentName:"td"},"(limit)")),(0,l.kt)("td",{parentName:"tr",align:null},"480 MB"),(0,l.kt)("td",{parentName:"tr",align:null},"48%"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("i",null,"402 ms*"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"3000"),(0,l.kt)("td",{parentName:"tr",align:null},"150 Mbps"),(0,l.kt)("td",{parentName:"tr",align:null},"6.6 Gbps"),(0,l.kt)("td",{parentName:"tr",align:null},"9.2 Gbps ",(0,l.kt)("em",{parentName:"td"},"(limit)")),(0,l.kt)("td",{parentName:"tr",align:null},"560 MB"),(0,l.kt)("td",{parentName:"tr",align:null},"50%"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("i",null,"514 ms*"))))))}d.isMDXComponent=!0}}]);